<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<head>
    <title>小易爱车后台管理系统</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" >
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <link rel="stylesheet" type="text/css" href="css/foundation-5.5.3.min.css" >
    <link rel="stylesheet" type="text/css" href="css/app.css" >
</head>
<body>
  <div class="wrap">
    <div class="header"></div>
    <div class="container">
      <nav class="topNav">
        <div class="right">
          <div class="user_avatar" data-dropdown="hover" data-options="is_hover:true; ">
            <img src="../img/head.png" alt="">
          </div>
          <ul id="hover" class="f-dropdown" data-dropdown-content>
            <li>
              <a href="">退出</a>
            </li>
          </ul>
        </div>
      </nav>
      <div class="template">
        <div class="breadCrumb">
          <div class="titles left">
            <h3>预约记录</h3>
            <p class="page_breadcrumbs">
              <a href="index.html">首页</a>
              <i class="fa fa-fw">/</i>
              <span>预约记录</span>
            </p>
          </div>
          <a href="stats.html" class="button radius rightConner right green">
            <i class="fa fa-line-chart fa-fw" ></i>统计
          </a>
        </div>
        <div class="mainContent">
          <div class="modules">
            <div class="row filter_fix">
              <form method="get">
                <div class="large-2 columns">
                  <input type="text" value="" id='re_name' placeholder="预约人搜索">
                </div>
               <!--  <div class="large-2 columns">
                  <input type="text" value="" id='re_id' placeholder="预约号搜索">
                </div> -->
                <div class="large-2 columns end">
                  <a id="con_search"  class="button small ran_search">搜索</a>
                </div>
              </form>
            </div>
            <div class="row">
              <div class="large-12 columns pd-0">
                <table role="grid" class="cus_table">
                  <thead>
                    <tr>
                      <th width="20">序号</th>
                      <th width="80">订单号</th>
                      <th width="50">预约人</th>
                      <th width="150">预约地址</th>
                      <th width="100">预约上门时间</th>
                    </tr>
                  </thead>
                  <tbody id='content_body'>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="row">
              <div class="large-12 columns pageination_fix">
                <span class="pagination_count">共<span id='sum_count'></span>条记录 | 每页<span id='page_num'></span>条 </span>
                <ul class="pagination right" id='mypager'>
                  <li class="current sy"><a>首页</a></li>
                  <li class="current syy"><a>上一页</a></li>
                  <li class="current xyy"><a>下一页</a></li>
                  <li class="current wy"><a>尾页</a></li>
				</ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
 <!-- Script -->
   <script src="../js/jquery-1.11.3.min.js"></script>
  <script src="js/tether.min.js"></script>
  <script src="js/jquery.components.min.js"></script>
  <script src="js/foundation.min.js"></script>
  <script src="js/public.js"></script>
  <script src="js/common.js"></script>
  <script src="../js/pub_fuc.js"></script>
  <script type="text/javascript">
  
$(function(){
	$(".header").load("public.html");
	loadData(1);
});

var re_name ='';
var re_id = '';
var number = 10;
var flag = true;


function loadData(page){
	nativeAjax('get','../api/reservation/getByPerson?rperson='+re_name+'&page='+page+'&number='+number,function(e){
		//console.log(getResult(e));
		var data = jsonParse(getResult(e));
		//console.log(data);
		if(data.code!='0'){
			document.getElementById('content_body').innerHTML = '';
			return;
		}
		
		var arr = data.data;
		var html = '';
	
			//console.log(arr.length);
		for(var i=0,len=arr.length;i<len;i++){
			var obj = arr[i];
			html +='<tr id='+obj.id+'>'
            +'<td>'+(i+1)+'</td>'
            +'<td>'+obj.id+'</td>'
            +'<td>'+obj.rperson+'</td>'
            +'<td>'+obj.address+'</td>'
            +'<td>'+obj.onTime+'</td>'
            +'</tr>';
		}
		document.getElementById('content_body').innerHTML = html;
		document.getElementById('sum_count').innerHTML = data.num;
		document.getElementById('page_num').innerHTML = number;
		opera();
		if(flag){
			pagebutton(data.size);
			flag = false;					
		}
	});
}


function opera(){
	$('#content_body').on('click','tr',function(e){
		//filter phone
		var tid  = e.currentTarget.id;
		window.location.href = 'booking_detail.html?tid='+tid;
	});
	
}


$('#con_search').click(function(){
	re_name = document.getElementById('re_name').value;
	loadData(1);
});

</script>
</body>
</html>
