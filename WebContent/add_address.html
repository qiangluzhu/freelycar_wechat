<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->
<head>
    <title>新增地址</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" >
    <link rel="stylesheet" type="text/css" href="css/style.css" />
</head>
<body>
    <div class="cont">
        <table>
            <tbody>
                <tr><p>联系人</p></tr>
                <tr>
                    <input  id='name' type="text" maxlength="6" value=""/></tr>
                <tr><p>车牌号</p></tr>
                <tr>
                    <div style="position:relative;">
                        <input id='license' type="text" maxlength="7" value=""/>
                    </div>
                </tr>
                <tr><p>联系电话</p></tr>
                <tr>
                    <input id='phone' type="tel" maxlength="11" value="" />
                </tr>
                <!-- <tr><p>所在地区</p></tr>
                <div id='city_box'>
                   	<select id='province' class="prov">
                   	</select>
                   	<select id='city' class="city" disabled="disabled">
                   	</select>
                   	<select id='region' class="dist" disabled="disabled">
                   	</select>
                </div> -->
                <tr><p>定点上门服务地址</p></tr>
                <tr>
                    <select style="width:100%" id='address'>
                    	<option value='小易爱车银城总部服务点--银城广场'>小易爱车银城总部服务点--银城广场</option>
                    	<option value='江东北路289号瑞园'>江东北路289号瑞园</option>
                    	<option value='南京市鼓楼区漓江路7号'>南京市鼓楼区漓江路7号</option>
					</select>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="foot_button">
        <div class="submit_button" id='submit_button'>提交</div>
    </div>
    
    <script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="http://webapi.amap.com/maps?v=1.3&key=ae721b47f9c198651a4bfecec901aa8c"></script>
	<!-- <script type="text/javascript" src="js/jquery.cityselect.js"></script>  -->
	<script type="text/javascript" src="js/pub_fuc.js"></script>
	<script type="text/javascript">
	var openId  = getCookie('openId');
	//var openId  = 'oBaSqs4RpSZNY7czNBcCRF8uYLKI';
	
	$(function(){
		/* $("#city_box").citySelect({  
		    url:"js/city.min.js",  
		    prov:'江苏', //省份 
		    city:'南京', //城市 
		    dist:'建邺区', //区县 
		    nodata:"none" //当子集无数据时，隐藏select 
		}); */
	})
	
	 nativeAjax('get','api/user/getAddById?id='+openId,function(e){
			var data = jsonParse(getResult(e));
			//console.log(data);
			if(data.code=='0'){//
				var obj = data.data;
				document.getElementById('name').value = obj.name;
				document.getElementById('license').value = obj.license;
				document.getElementById('phone').value = obj.phone;
				document.getElementById('address').value = obj.address;
				submit(obj.id);
			}else{
				submit();
			}
			
			
	});
	
	var submit = function(id){
		$('#submit_button').click(function(){
			var arr = ['name','license','phone','address'];
			var param={openId:openId,'isSelected':'1'};
			if(isNotEmpty(id)){
				param.id = id;
			}
			
			for(var i=0,len=arr.length;i<len;i++){
				var tid = arr[i];
				var ele = document.getElementById(tid);
				var value = ele.value;
				if(isEmpty(value)){
					ele.style.borderColor = 'red';
					return;
				}else{
					ele.style = '';
				}
				param[tid] = value;
			}
			//console.log($.param(param));
			nativeAjax('post','api/user/modAddress',function(e){
				var data = jsonParse(getResult(e));
				//console.log(data);
				//alert(JSON.stringify(data, null, 4));
				if(data.code=='0'){
					window.location.href ='service.html';
				}
				
			},$.param(param)); 
			
		});
		
	}
	

	</script>
    
    </body>
</html>
